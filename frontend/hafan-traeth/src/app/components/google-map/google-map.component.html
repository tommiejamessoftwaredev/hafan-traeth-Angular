<div class="map-widget">
  <div class="map-header">
    <h3>Our Location</h3>
    <p>ğŸ“ 10 Ceri Ave, Prestatyn LL19 7YN</p>
    <p>ğŸ”— What3Words: ///funny.cherub.hospitals</p>
  </div>
  
  <div class="map-container">
    <!-- Google Maps Angular Component -->
    <div *ngIf="!showFallback && mapLoaded" class="interactive-map">
      <google-map 
        [center]="center"
        [zoom]="zoom"
        [options]="mapOptions"
        width="100%"
        height="400px"
        (mapInitialized)="onMapReady()"
        (mapError)="onMapError($event)">
        
        <map-marker 
          [position]="markerPosition"
          [options]="markerOptions"
          title="Hafan Traeth - Your Coastal Retreat">
        </map-marker>
        
        <!-- Beach Marker (only when showing directions) -->
        <map-marker 
          *ngIf="showingDirections"
          [position]="getBeachLocation()"
          title="Ffrith Beach - Your destination">
        </map-marker>
        
        <!-- Shop Markers -->
        <ng-container *ngIf="showingShops">
          <map-marker 
            *ngFor="let shop of localShops; trackBy: trackByShopName"
            [position]="shop.location"
            [title]="shop.name + ' - ' + shop.type">
            
            <map-info-window>
              <div class="shop-info-content">
                <h4>ğŸª {{ shop.name }}</h4>
                <p><strong>{{ shop.type }}</strong></p>
                <p>{{ shop.description }}</p>
              </div>
            </map-info-window>
          </map-marker>
        </ng-container>
        
        <map-info-window>
          <div class="map-info-content">
            <h4>ğŸ¡ Hafan Traeth</h4>
            <p>Your perfect coastal retreat</p>
            <strong>ğŸ“ 10 Ceri Ave, Prestatyn LL19 7YN</strong>
          </div>
        </map-info-window>
      </google-map>
    </div>
    
    <!-- Fallback Map -->
    <div *ngIf="showFallback" class="fallback-map">
      <iframe 
        src="https://www.openstreetmap.org/export/embed.html?bbox=-3.441334999915092,53.32336569521891,-3.421334999915092,53.34336569521891&amp;layer=mapnik&amp;marker=53.33336569521891,-3.431334999915092"
        width="100%" 
        height="400" 
        style="border: none; border-radius: 8px;"
        title="Property Location Map">
      </iframe>
      <div class="fallback-notice">
        <p>ğŸ“ <strong>Hafan Traeth</strong> - 10 Ceri Ave, Prestatyn LL19 7YN</p>
        <small>Interactive map unavailable - showing OpenStreetMap fallback</small>
      </div>
    </div>
    
    <!-- Loading state -->
    <div class="map-placeholder" *ngIf="!mapLoaded">
      <div class="loading-spinner"></div>
      <p>Loading interactive map...</p>
    </div>
  </div>
  
  <div class="location-features">
    <div class="feature-grid">
      <div class="feature-item clickable" [class.active]="showingDirections" (click)="showBeachDirections()">
        <span class="icon">ğŸ–ï¸</span>
        <div class="feature-text">
          <h5>Beach Access</h5>
          <p>5 minute walk to Ffrith Beach</p>
          <small class="directions-hint">{{ showingDirections ? 'Click to hide directions' : 'Click for walking directions' }}</small>
        </div>
      </div>
      
      <div class="feature-item">
        <span class="icon">ğŸš—</span>
        <div class="feature-text">
          <h5>Parking</h5>
          <p>Free on-site parking available</p>
        </div>
      </div>
      
      <div class="feature-item clickable" [class.active]="showingShops" (click)="showLocalShops()">
        <span class="icon">ğŸª</span>
        <div class="feature-text">
          <h5>Local Shops</h5>
          <p>Prestatyn town center nearby</p>
          <small class="directions-hint">{{ showingShops ? 'Click to hide shops' : 'Click to show local shops' }}</small>
        </div>
      </div>
      
      <div class="feature-item">
        <span class="icon">ğŸšŒ</span>
        <div class="feature-text">
          <h5>Public Transport</h5>
          <p>Bus routes to Rhyl and Chester</p>
        </div>
      </div>
    </div>
  </div>
  
  <div class="directions-section">
    <h4>Getting Here</h4>
    <div class="transport-options">
      <div class="transport-option">
        <strong>ğŸš— By Car:</strong>
        <p>From Chester: 45 minutes via A55<br>
           From Manchester: 1.5 hours via A55</p>
      </div>
      
      <div class="transport-option">
        <strong>ğŸš‚ By Train:</strong>
        <p>Prestatyn Railway Station: 1 mile<br>
           Direct services from Chester & Holyhead</p>
      </div>
      
      <div class="transport-option">
        <strong>âœˆï¸ By Air:</strong>
        <p>Liverpool Airport: 1 hour<br>
           Manchester Airport: 1.5 hours</p>
      </div>
    </div>
    
    <div class="action-buttons">
      <button class="directions-btn" (click)="openDirections()">
        ğŸ“ Get Directions
      </button>
      <button class="satellite-btn" (click)="toggleMapType()">
        ğŸ›°ï¸ {{ mapType === 'roadmap' ? 'Satellite View' : 'Road View' }}
      </button>
    </div>
  </div>
</div>
